# Setting up a Log4Shell-exploitable version with docker-compose

**Prerequisites:**

* Docker
* docker-compose

**Note:** The docker-compose setup takes care of the whole setup described [here](log4shell_exploitation_setup_manual.md) and generates load as described [here](load_generation_docker.md) in just two simple commands.

Build Docker images:

```console
./build_docker_images.sh
```

Create and run Docker containers:

```console
docker-compose up -d
```

You can then access the bank application at <http://localhost:8080/insecure-bank/>.

**Note:** If you want to adapt the default timeframe for the loadgen to create attacks (between 22:00 and 7:00 UTC time), you can change the `LOADGEN_UTC_START_HOUR` and `LOADGEN_UTC_END_HOUR` environment variables in the `docker-compose.yml` file, e.g. as follows:

```console
    environment:
      - INSECURE_BANK_ENDPOINT=http://insecure-bank:8080
      - LOADGEN_UTC_START_HOUR=0
      - LOADGEN_UTC_END_HOUR=24
```

## Gathering information about what's happening inside

Investigating the output and logs of the application and the LDAP/HTTP servers can then be achieved by issuing these commands (in separate terminals):

```console
docker logs -f insecure-bank
docker exec insecure-bank tail -f /root/target/cargo/configurations/tomcat9x/logs/insecure-bank.log
docker exec insecure-bank tail -f /root/ldap_server1.log
docker exec insecure-bank tail -f /root/ldap_server2.log
docker exec insecure-bank tail -f /root/http_server.log
```
